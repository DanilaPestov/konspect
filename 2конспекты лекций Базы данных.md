# Базы данных
---
### *Лекция 1. Знакомство с базами данных*
---
CУБД — это система управления базами данных
СУБД-ИНСТРУМЕНТ

Базы данных **нужны для хранения, обработки и быстрого извлечения** необходимой информации
Необходимо составить базу данных для картинной галереи

**Иерархическая модель хранения данных**
*При создании иерархической базы данных
изначально фиксируем сценарий использования этой базы*

Иерархическая модель удобна, если она создаётся под конкретную задачу. 
***Решение*** – предметный указатель

Главное ограничение иерархической структуры — отсутствие гибкости.
Она сразу определяет сценарий использования данных.

**Реляционные базы данных**
Relation – связь
**Реляционные базы данных** – это базы данных, в которых
данные распределены по отдельным, связанным между собой, таблицам
- телефонный справочник
Первичный ключ — ID, уникальная информация,
которая позволяет идентифицировать каждую конкретную запись таблицы
Внешний ключ — ID из дополнительной таблицы (уже не уникальный). 
Позволяет найти информацию из основной таблицы
***При связке нескольких таблиц необходим уникальный идентификатор***
Реляционные базы данных (от англ. Relation – связь) — базы данных, 
в которых данные распределены по отдельным, но связанным между собой таблицам

---
### *Лекция 2. Работа с данными из разных таблиц*
---
Введение. Начало работы с файлом «Стартовый файл. Телефонный справочник»

Базы данных нужны для хранения, обработки и быстрого извлечения необходимой информации.
 
В рамках лекции мы используем псевдокод!
**SQL** – это особый язык программирования, 
который позволяет формулировать то, что нужно сделать с данными в таблицах
***В рамках лекции мы используем псевдокод!***
**FROM** – «из» указываем, откуда необходимо выбрать информацию
**Общий список** – название таблицы из нашего примера

- Задача 1.
**SELECT * FROM** «Общий список»
**SELECT** – «выбери»;
__*__ – после SELECT указывается набор столбцов, * означает что мы хотим видеть все столбцы
**FROM** – «из» указываем, откуда необходимо выбрать информацию
- Задача 2.
**SELECT** «ФИО», «Тел», «Комментарий»
**FROM** «Общий список».
- Задача 3.
**SELECT** «ФИО», «Тел», «Комментарий».
**FROM** «Общий список».
**WHERE** статус = «холост»
Значок **«=»** — если статус равен «холост», то условие выполняется
#### *Способы связывания таблиц между собой*:
- inner join
- left join
- right join
- full join

*Примеры использования **INNER JOIN** (выводит все данные, относящиеся как к одной и ко второй таблице)*
**JOIN** — объединение, **INNER** — внутренний:
общая информация из двух табличек (пересечение),
нет «пустых» значений.
INNER JOIN Люди, Телефоны 
ON id = «Чей телефон»

***Сначала из разных таблиц программа собирает одну таблицу по нашему
условию, из которой мы можем получать информацию***

**INNER JOIN** Люди, Адреса_2 
**ON id** = «Чей адрес»
*Адреса_2 — в таблице есть адрес, который не относится ни к кому из указанных в таблице людей*

*Примеры использования **LEFT JOIN** (выводит все данные, относящиеся к первой и в пересечении между первой и второй таблицей)*

**LEFT JOIN** Люди, Адреса_2
**ON id** = «Чей адрес»
*Адреса_2 — в таблице есть адрес, который не относится ни к кому из указанных в таблице людей*
В новую таблицу переходят все данные из первой (левой) таблицы, к ним добавляются соответствующие данные из второй (правой).

**INNER JOIN** и **LEFT JOIN** вернули в данном случае одинаковый результат → у нас в левой таблице нет данных, которые выходили бы за границу пересечения.

***Если мы поменяем местами таблички «Люди» и «Адреса_2», то «Адреса_2» будет следва, а «Люди» — справа***

- В левой таблице «Адреса_2» есть данные, которых нет во второй таблице.
- Эту запись переносим в новую таблицу. Соответствующего значения из второй таблицы нет, поэтому все ячейки с недостающими данными заполняем заглушкой «нет».
- **С INNER JOIN** не может быть пустых ячеек: он берёт только пересекающиеся значения

*Примеры использования **RIGHT JOIN** (выводит все данные, относящиеся ко второй таблице и в пересечении второй и первой таблицей)*
**RIGHT JOIN** «Люди», «Адреса_2»
**ON id** = «Чей адрес»
Берём все данные из таблицы «Адреса_2» и соответствующие им значения из таблицы «Люди», где id совпадает с «Чей адрес»

***LEFT JOIN и RIGHT JOIN не симметричны, но хорошо друг друга заменяют***

*Примеры использования **FULL JOIN** (выводит все данные, из двух таблиц соединяются в одну)*
Одновременное использование **LEFT JOIN** и **RIGHT JOIN**
*Берём данные, которые:*
1. есть в обеих таблицах;
2. есть только в левой таблице (недостающие значения заполняем значением по умолчанию, например, «нет»);
3. есть только в правой таблице (недостающие значения заполняем значением по умолчанию, например, «нет»).

---
### *Лекция 3. Создание структуры базы данных*
---
**Описание структуры данных таблиц**
На примере файла с прошлой лекции (телефонный справочник):
В каждую таблицу добавлен уникальный идентификатор:
p_id — уникальный идентификатор человека(вместо id) 
t_id — уникальный идентификатор телефона(вместо чей телефон) 
a_id — уникальный идентификатор адреса(вместо чей адрес)

*Если мы изначально хотим заложить возможность фильтрации данных по фамилии или имени,то Фамилия, Имя и Отчество
должны храниться в базах данных отдельно*

**Cоздание структуры базы данных**
Одна книга могла быть написана несколькими авторами
Автор мог написать несколько книг

У одного клиента может быть несколько номеров
Но за номером закреплен лишь один клиент

Данные о статусе (семейном положении) обычно хранятся не текстом,
а с помощью идентификаторов (в отдельном справочнике)
Например:
1 — холост, 2 — женат, 3 — разведён.

**Общие рекомендации по подготовке структуры хранения данных:**
- Добавлять уникальные идентификаторы в каждую таблицу
- Указывать тип данных
- Использовать особый тип данных для даты или времени
- Заранее рассчитывать длину полей
- Использовать справочники для повторяющихся данных
(семейное положение, город и других)
- Дробить информацию на несколько полей, если это соответствует вероятным будущим задачам работы с БД. Например, можно разнести значения из «ФИО», номера телефонов и т.д.

**Тип данных TimeStamp — сочетание даты и времени**

*Типы связей между таблицами:*
1. Один к одному
(ребенок -> родитель)
Одно свидетельство о рождении соответствует одному человеку
2. Один ко многим
Один мужчина был женат на нескольких женщинах. У одной женщины несколько детей.
3. Многое ко многому
По одному адресу зарегистрированы несколько людей, и у каждого человека,
в свою очередь, может быть несколько адресов: фактический и адрес регистрации, например.

**Как сделать оптимальную базу данных:**
- Понять, какие бывают ситуации и кейсы
- Понять, какая информация может понадобится в разных кейсах.
- Понять, какой путь проходит клиент от момента начала коммуникации с сервисом до завершения какая информация сопровождает этот путь.
- На этапе создания базы данных придумывать кейсы, в которых ваша база данных может «сломаться».

---
### *Лекция 4. Дополнительная лекция*
---

**TimeStamp** — для фиксации событий одного дня